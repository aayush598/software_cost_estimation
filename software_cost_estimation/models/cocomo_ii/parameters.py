"""Model parameters and lookup tables extracted from COCOMO II (2000) manual."""

from __future__ import annotations

from typing import Dict

# ---------------------------------------------------------------------------
# Mathematical constants (COCOMO II.2000 calibration)
# ---------------------------------------------------------------------------
A = 2.94
B = 0.91
C = 3.67
D = 0.28

# ---------------------------------------------------------------------------
# Scale‑factor weights (Table 10)
# ---------------------------------------------------------------------------
ScaleTable: Dict[str, Dict[str, float]] = {
    "PREC": {"VL": 6.20, "L": 4.96, "N": 3.72, "H": 2.48, "VH": 1.24, "XH": 0.0},
    "FLEX": {"VL": 5.07, "L": 4.05, "N": 3.04, "H": 2.03, "VH": 1.01, "XH": 0.0},
    "RESL": {"VL": 7.07, "L": 5.65, "N": 4.24, "H": 2.83, "VH": 1.41, "XH": 0.0},
    "TEAM": {"VL": 5.48, "L": 4.38, "N": 3.29, "H": 2.19, "VH": 1.10, "XH": 0.0},
    "PMAT": {"VL": 7.80, "L": 6.24, "N": 4.68, "H": 3.12, "VH": 1.56, "XH": 0.0},
}

SCALE_KEYS = tuple(ScaleTable.keys())

# ---------------------------------------------------------------------------
# Effort‑multiplier lookup tables (COCOMO II Post‑Architecture, 17 EMs)
# ---------------------------------------------------------------------------

_EM = {
    # Product factors
    "RELY": {"VL": 0.82, "L": 0.92, "N": 1.00, "H": 1.10, "VH": 1.26, "XH": 1.40},
    "DATA": {"VL": 0.90, "L": 0.90, "N": 1.00, "H": 1.14, "VH": 1.28, "XH": 1.28},
    "CPLX": {"VL": 0.73, "L": 0.87, "N": 1.00, "H": 1.17, "VH": 1.34, "XH": 1.74},
    "RUSE": {"VL": 0.95, "L": 0.95, "N": 1.00, "H": 1.07, "VH": 1.15, "XH": 1.24},
    "DOCU": {"VL": 0.81, "L": 0.91, "N": 1.00, "H": 1.11, "VH": 1.23, "XH": 1.23},

    # Platform factors
    "TIME": {"VL": 1.00, "L": 1.00, "N": 1.00, "H": 1.11, "VH": 1.29, "XH": 1.63},
    "STOR": {"VL": 1.00, "L": 1.00, "N": 1.00, "H": 1.05, "VH": 1.17, "XH": 1.46},
    "PVOL": {"VL": 0.87, "L": 0.87, "N": 1.00, "H": 1.15, "VH": 1.30, "XH": 1.30},

    # Personnel factors
    "ACAP": {"VL": 1.42, "L": 1.19, "N": 1.00, "H": 0.85, "VH": 0.71, "XH": 0.71},
    "PCAP": {"VL": 1.34, "L": 1.15, "N": 1.00, "H": 0.88, "VH": 0.76, "XH": 0.76},
    "APEX": {"VL": 1.29, "L": 1.12, "N": 1.00, "H": 0.90, "VH": 0.81, "XH": 0.81},
    "PLEX": {"VL": 1.19, "L": 1.09, "N": 1.00, "H": 0.91, "VH": 0.85, "XH": 0.85},
    "LTEX": {"VL": 1.20, "L": 1.09, "N": 1.00, "H": 0.91, "VH": 0.84, "XH": 0.84},

    # Project factors
    "TOOL": {"VL": 1.17, "L": 1.09, "N": 1.00, "H": 0.90, "VH": 0.78, "XH": 0.65},
    "SITE": {"VL": 1.22, "L": 1.09, "N": 1.00, "H": 0.93, "VH": 0.86, "XH": 0.80},
    "SCED": {"VL": 1.43, "L": 1.14, "N": 1.00, "H": 1.00, "VH": 1.00, "XH": 1.00},
}

EMTable: Dict[str, Dict[str, float]] = _EM  # re‑export alias
EM_KEYS = tuple(_EM.keys())

